#include "customized.h"
#include "../system.h"

Customized::Customized(System *system)
    : InitialWeights(system)
{
    m_system = system;
}

void Customized::setupInitialWeights()
{
    m_numberOfElements = m_system->getNumberOfElements();
    m_maxParameters = m_system->getMaxParameters();
    m_parameters = Eigen::MatrixXd::Zero(m_numberOfElements, m_maxParameters);

    /* Optimal parameters found for a dense neural network with a hidden layer containing
     * 25 hidden nodes. The parameters were generated by TensorNet, see
     * www.github.com/evenmn/tensornet */

    m_parameters <<  3.45070834e-01,
                     6.02413804e-01,
                    -1.56738935e+00,
                     5.99258276e-01,
                    -7.09137240e-01,
                    -1.02586198e+00,
                    -1.09800632e+00,
                     4.88431761e-03,
                     3.75002528e-01,
                     3.67042745e-01,
                    -1.29697377e-03,
                     5.40758084e-01,
                     3.26861366e-01,
                     6.04046358e-01,
                     5.77852918e-01,
                     3.55325330e-01,
                     6.07037429e-01,
                    -1.20072282e+00,
                     5.54086234e-01,
                    -1.82779621e+00,
                    -9.81914044e-01,
                    -6.27003019e-01,
                    -7.90292251e-05,
                    -5.94761505e-04,
                     6.16925020e-01,
                     5.27001086e-02,
                    -2.11005606e-01,
                    -2.37117944e-01,
                    -7.26199236e-01,
                    -2.18612731e-01,
                    -5.02037874e-01,
                     4.04449526e-01,
                    -1.31356159e+00,
                    -2.30449736e-03,
                    -1.06046910e-01,
                    -1.62971845e-01,
                     2.87885417e-03,
                    -2.13749235e-01,
                    -2.22979006e-01,
                    -2.05735360e-01,
                    -1.96410977e-01,
                    -2.14940753e-01,
                    -1.56055414e-01,
                     2.01067589e-01,
                    -1.88241280e-01,
                     2.39615630e-01,
                     1.80494316e-01,
                    -1.66225896e+00,
                    -1.73290042e-03,
                    -7.06542544e-04,
                    -2.20656456e-01,
                     1.01113499e-01,
                     1.55890714e-01,
                     5.01589127e-01,
                     1.86659201e-01,
                     2.53021386e-01,
                    -6.53703380e-01,
                    -6.14581636e-01,
                     2.06654222e-04,
                     1.24917033e-01,
                     2.94944761e-02,
                     3.00174959e-03,
                     1.40513106e-01,
                     4.30006246e-02,
                     1.85879327e-01,
                     1.29624873e-01,
                     1.06273963e-01,
                     1.57508405e-01,
                    -2.42745197e-01,
                     1.42242070e-01,
                     6.57608677e-01,
                     1.10224153e+00,
                     5.29061184e-01,
                    -5.65288904e-04,
                    -4.39060817e-04,
                     1.50542995e-01,
                     1.57132180e-01,
                     1.43151658e-01,
                    -6.94089672e-02,
                     7.52012905e-02,
                     9.93329919e-01,
                    -6.70683959e-01,
                     6.06120487e-01,
                     2.65190293e-03,
                     1.34462479e-01,
                     3.29996727e-01,
                    -1.13508449e-03,
                     8.99325278e-02,
                     2.10548836e-01,
                     7.45086852e-02,
                     1.48687586e-01,
                     1.70457163e-01,
                     1.26759424e-01,
                     1.21440005e+00,
                     1.37046073e-01,
                     4.38009949e-01,
                    -3.87117997e-01,
                    -9.11021647e-01,
                     1.96613826e-03,
                     2.22438079e-03,
                     1.40711938e-01,
                     8.03069504e-03,
                    -1.76468019e-01,
                    -7.06906870e-01,
                    -1.78876170e-01,
                    -1.53603844e+00,
                    -1.07108368e+00,
                     3.94519465e-01,
                    -3.23505788e-03,
                    -1.44937034e-01,
                     1.20988333e-01,
                     2.39808217e-03,
                    -1.77403692e-01,
                     5.52853203e-02,
                    -1.70776232e-01,
                    -1.80377538e-01,
                     7.55245557e-03,
                    -1.85904975e-01,
                     3.13375249e-01,
                    -1.85978972e-01,
                    -9.44442655e-02,
                     4.47961989e-01,
                     8.86890959e-01,
                     1.72087727e-04,
                    -2.95234024e-04,
                    -1.82808755e-01,
                     3.00860307e-01,
                     5.12314807e-01,
                    -7.39599397e-02,
                     4.73177040e-01,
                    -8.51905608e-03,
                     1.75583335e-02,
                    -9.43398489e-02,
                    -8.77542417e-03,
                     4.01349934e-01,
                     4.05985881e-01,
                    -8.65020056e-03,
                     4.70775989e-01,
                     3.13428181e-01,
                     4.57515907e-01,
                     4.70296404e-01,
                     3.13604911e-01,
                     4.62286754e-01,
                     7.06980745e-03,
                     4.83094135e-01,
                    -5.69182285e-02,
                     2.29394585e-02,
                    -6.69740578e-02,
                    -7.25753731e-03,
                    -3.99616523e-03,
                     5.03534981e-01;
    m_system->updateAllParameters(m_parameters);
}

Eigen::MatrixXd Customized::getParameters()
{
    return m_parameters;
}
